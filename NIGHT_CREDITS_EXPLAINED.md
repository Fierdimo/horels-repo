# Night Credits (CrÃ©ditos de Noches) - ExplicaciÃ³n Detallada

**Documento:** GuÃ­a completa sobre cÃ³mo funcionan los crÃ©ditos de noches y su relaciÃ³n con intercambios

---

## 1. Â¿QuÃ© son los Night Credits (CrÃ©ditos de Noches)?

Los **night credits** son una moneda alternativa dentro del sistema que permite a los owners:
- **Convertir sus semanas** en noches flexibles
- **Usar las noches** en cualquier hotel del grupo (no solo en su propiedad original)
- **Aprovechar mejor** su tiempo disponible sin estar atado a fechas especÃ­ficas

### Ejemplo Visual

```
OPCIÃ“N A: Semana Tradicional
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mi Semana Roja (7 noches)          â”‚
â”‚ Maldivas - Jan 1-7, 2025            â”‚
â”‚ Status: Confirmada                  â”‚
â”‚ Puedo:                               â”‚
â”‚ - Usar esas fechas                  â”‚
â”‚ - Intercambiarla con otro owner      â”‚
â”‚ - Convertirla en crÃ©ditos            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â†“ CONVERTIR â†“

OPCIÃ“N B: CrÃ©ditos de Noches Flexibles
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mis CrÃ©ditos: 6 Noches              â”‚
â”‚ Vencimiento: Dec 2026                â”‚
â”‚ Puedo usar:                          â”‚
â”‚ - 6 noches en CUALQUIER hotel        â”‚
â”‚ - CUALQUIER fecha disponible         â”‚
â”‚ - Divididas: 2+2+2 o 3+3, etc       â”‚
â”‚ - Para el mismo owner (no transferible)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ConversiÃ³n de Semanas a CrÃ©ditos Nocturnos

**Regla Universal:**
- Toda semana de timeshare (exactamente 7 noches) se convierte en **7 crÃ©ditos nocturnos**
- El tipo de alojamiento (sencilla, duplex, suite, etc.) determina la calidad de la semana
- No hay diferencia en la cantidad de crÃ©ditos segÃºn el tipo de habitaciÃ³n

| Requisito | ConversiÃ³n |
|-----------|------------|
| **DuraciÃ³n de Semana** | Exactamente 7 noches |
| **CrÃ©ditos Otorgados** | 7 night credits |
| **Tipo de Alojamiento** | Cualquiera (sencilla, duplex, suite, etc.) |

**Importante:**
- Solo semanas completas de 7 noches califican para conversiÃ³n
- La conversiÃ³n es permanente y no puede revertirse
- El tipo de alojamiento original no afecta la cantidad de crÃ©ditos

---

## 3. CaracterÃ­sticas de Night Credits

### 3.1 Validez Temporal

```
CrÃ©ditos creados: 19 Dic 2025
    â†“
    â”œâ”€ VÃ¡lidos desde: Inmediatamente
    â”œâ”€ Vencimiento: 19 Dic 2026 / 2027
    â””â”€ Auto-consumo: Expiran si no se usan
```

**Reglas:**
- âœ… 18-24 meses desde creaciÃ³n (configurable)
- âœ… El owner recibe notificaciÃ³n con 30 dÃ­as antes de vencer
- âœ… No se pueden transferir a otro owner
- âœ… No tienen reembolso en efectivo si vencen

### 3.2 Restricciones de Uso

```
PUEDO USAR:
âœ… En cualquier propiedad del grupo
âœ… En cualquier fecha (si hay disponibilidad)
âœ… Divididos en mÃºltiples estancias
âœ… MÃ¡s de 1 vez por aÃ±o

NO PUEDO USAR:
âŒ PerÃ­odos de alta demanda (fechas pico)
   - Navidad (Dec 15 - Jan 5)
   - Semana Santa
   - Temporada de verano (Jul 15 - Aug 25)
   
âŒ Transferirlos a otro owner
âŒ Venderlos
âŒ Cambiarlos por dinero
```

**Â¿Por quÃ© hay restricciones?**
- Los perÃ­odos pico son para owners que confirmaron sus semanas
- Los crÃ©ditos estÃ¡n diseÃ±ados para llenar espacios vacÃ­os (offseason)

---

## 4. Â¿CrÃ©ditos vs Intercambios? - RelaciÃ³n Compleja

### 4.1 Flujo de DecisiÃ³n del Owner

```
â”Œâ”€ Tengo una semana â”
â”‚                    â”‚
â”œâ”€ Â¿Quiero usarla?
â”‚  â”œâ”€ SÃ­ â†’ Confirmar semana (sin costo)
â”‚  â””â”€ No â†“
â”‚
â”œâ”€ Â¿Quiero intercambiarla con otro owner?
â”‚  â”œâ”€ SÃ­ â†’ Crear solicitud de intercambio (gratis)
â”‚  â”‚       â”œâ”€ Si hay match â†’ Pagar â‚¬15 fee
â”‚  â”‚       â””â”€ Si NO hay match â†’ Seguir buscando
â”‚  â”‚
â”‚  â””â”€ No â†“
â”‚
â””â”€ Â¿Quiero convertirla en crÃ©ditos flexibles?
   â”œâ”€ SÃ­ â†’ Convertir (sin costo)
   â”‚       â”œâ”€ Recibo X noches
   â”‚       â”œâ”€ Pierdo la semana
   â”‚       â””â”€ Tengo flexibilidad temporal
   â”‚
   â””â”€ No â†“ (Hacer nada, semana sigue disponible)
```

### 4.2 Comparativa: Intercambio vs ConversiÃ³n

| Aspecto | **Intercambio (Swap)** | **ConversiÃ³n (Credits)** |
|---|---|---|
| **Costo** | â‚¬15 si hay match | Gratis |
| **Resultado** | Cambio de semana por otra semana | Noches flexibles |
| **Fechas** | EspecÃ­ficas (dates fijos) | Flexibles (cualquier fecha) |
| **Propiedad** | Puedo elegir quÃ© hotel | Cualquier hotel del grupo |
| **Requiere** | Otro owner dispuesto | Solo yo |
| **Validez** | Inmediata (nueva semana confirmada) | Limitada en tiempo (18-24 meses) |
| **Beneficio** | Cambio de destino/fecha | MÃ¡xima flexibilidad |

---

## 5. Casos de Uso Reales

### Caso A: Intercambio es mejor

```
Soy Sarah (EspaÃ±a)
Tengo: Roja Week (Maldivas, Julio)
Quiero: Semana en ParÃ­s (Octubre)

ACCIÃ“N: Intercambio
â”œâ”€ Busco owner con Paris/Oct
â”œâ”€ Find: Ahmed (Paris, Oct) quiere Maldivas
â”œâ”€ Propongo intercambio
â”œâ”€ â‚¬15 fee si se completa
â””â”€ RESULTADO: Confirmo viaje a Paris en Oct

Â¿Por quÃ© NO conversiÃ³n?
- Quiero fechas ESPECÃFICAS (Oct, vacaciones escolares)
- Quiero DESTINO ESPECÃFICO (Paris)
- La conversiÃ³n no me darÃ­a eso
```

### Caso B: ConversiÃ³n es mejor

```
Soy Marcos (Italia)
Tengo: 3 Semanas de 7 noches cada una
SituaciÃ³n: Tengo 3 semanas pero incierto cuÃ¡ndo podrÃ© usarlas
Quiero: Flexibilidad mÃ¡xima

ACCIÃ“N: ConversiÃ³n
â”œâ”€ 3 semanas Ã— 7 noches = 21 crÃ©ditos nocturnos
â”œâ”€ Pierdo las 3 semanas
â”œâ”€ Recibo 21 crÃ©ditos vÃ¡lidos 18 meses
â”œâ”€ Puedo usar:
â”‚  â”œâ”€ 7 noches en Agosto
â”‚  â”œâ”€ 7 noches en Diciembre
â”‚  â””â”€ 7 noches en Marzo
â””â”€ RESULTADO: MÃ¡xima flexibilidad

Â¿Por quÃ© NO intercambio?
- Incierto de fechas exactas
- Quiero mÃºltiples opciones
- Los crÃ©ditos me dan libertad total
```

### Caso C: Ambas opciones (Estrategia Mixta)

```
Soy Lisa (Alemania)
Tengo: 2 Semanas (Junio cada aÃ±o)

ESTRATEGIA:
â”œâ”€ Semana 1 (Junio): Confirmar â†’ UsarÃ© junio
â”œâ”€ Semana 2 (Junio): Convertir â†’ 7 crÃ©ditos flexibles
â”‚
RESULTADO:
â”œâ”€ Disfruto mi semana confirmada en junio
â””â”€ Tengo 7 noches para cuando lo necesite

VENTAJA: Lo mejor de ambos mundos
```

---

## 6. Flujo de Uso de Night Credits

### 6.1 Crear CrÃ©ditos (ConversiÃ³n)

```
â”Œâ”€ Mi Semana (Suite) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Maldivas, Aug 1-8, 2025 (7 noches) â”‚
â”‚ Status: Available                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“ [Convertir a CrÃ©ditos]
                 
â”Œâ”€ ConfirmaciÃ³n â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "PerderÃ¡s esta semana"             â”‚
â”‚ "RecibirÃ¡s 7 crÃ©ditos"             â”‚
â”‚ "VÃ¡lidos hasta: Feb 2027"           â”‚
â”‚ [CANCELAR] [CONFIRMAR]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“ CONFIRMAR
                 
âœ… CONVERTIDO
â”œâ”€ Semana â†’ ELIMINA
â””â”€ CrÃ©ditos â†’ CREA (7 noches)
```

### 6.2 Usar CrÃ©ditos

```
â”Œâ”€ Mis CrÃ©ditos â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7 Noches disponibles               â”‚
â”‚ Vencimiento: Feb 2027              â”‚
â”‚ [USAR CRÃ‰DITOS]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€ Selecciona Viaje â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¨ Propiedad: [Villa Maldivas â–¼]   â”‚
â”‚ ğŸ“… Fecha: [Aug 10 â–¼]               â”‚
â”‚ ğŸ›ï¸ Noches: [3 â–¼]                    â”‚
â”‚ [BUSCAR DISPONIBILIDAD]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
âœ… DISPONIBLE
â”œâ”€ Previeww: Aug 10-13 (3 noches)
â”œâ”€ CrÃ©ditos a usar: 3
â”œâ”€ Resto: 2 crÃ©ditos despuÃ©s
â””â”€ [CONFIRMAR BOOKING]
                 â†“
ğŸ‰ BOOKING CREADO
â”œâ”€ Confirmation #12345
â”œâ”€ CrÃ©ditos: 5 â†’ 2 (restantes)
â””â”€ Email de confirmaciÃ³n enviado
```

---

## 7. RelaciÃ³n con el Negocio

### 7.1 Ventaja para la Plataforma

| Aspecto | Beneficio |
|---|---|
| **Intercambios** | â‚¬15 por transacciÃ³n completada |
| **ConversiÃ³n** | Cero ingresos directo, PERO: |
| | â€¢ Owner comprometido a usar |
| | â€¢ Propiedad se llena (occupancy â†‘) |
| | â€¢ Datos de comportamiento |
| | â€¢ RetenciÃ³n a largo plazo |

### 7.2 Ventaja para el Owner

| Aspecto | Beneficio |
|---|---|
| **Intercambio** | Cambio de destino especÃ­fico (costo: â‚¬15) |
| **CrÃ©ditos** | MÃ¡xima flexibilidad (costo: $0) |

### 7.3 Ventaja para los Hoteles

| Aspecto | Beneficio |
|---|---|
| **Confirmar semana** | Booking garantizado (revenue seguro) |
| **Intercambio** | Nuevo destino visitado (occupancy) |
| **CrÃ©ditos** | Llenan offseason (ocupaciÃ³n durante baja demanda) |

---

## 8. RelaciÃ³n Entre Intercambios y CrÃ©ditos

### NO son excluyentes

```
MISMA SEMANA NO PUEDE:
âœ… Estar intercambiada Y convertida al mismo tiempo
âœ… La Ãºnica opciÃ³n es una: INTERCAMBIO, CONVERSIÃ“N o CONFIRMADA

PERO MÃšLTIPLES SEMANAS:
âœ… Semana 1 â†’ Intercambio
âœ… Semana 2 â†’ ConversiÃ³n
âœ… Semana 3 â†’ Confirmada
âœ… TODO AL MISMO TIEMPO
```

### Flujo Completo del Owner

```
ESCENARIO: Owner con 3 semanas (Red, Blue, White)

ACCIÃ“N:
â”Œâ”€ ROJA (Junio) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quiero fechas especÃ­ficas          â”‚
â”‚ AcciÃ³n: INTERCAMBIO                â”‚
â”‚ Status: Buscando match              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ AZUL (Agosto) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quiero mÃ¡xima flexibilidad         â”‚
â”‚ AcciÃ³n: CONVERSIÃ“N â†’ 5 crÃ©ditos     â”‚
â”‚ Status: Convertida                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ BLANCA (Octubre) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Seguro que la usarÃ© esas fechas    â”‚
â”‚ AcciÃ³n: CONFIRMADA                 â”‚
â”‚ Status: Reservada para octubre      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULTADO:
â”œâ”€ 1 Intercambio en proceso
â”œâ”€ 5 CrÃ©ditos en bolsa
â””â”€ 1 Semana confirmada
```

---

## 9. ImplementaciÃ³n TÃ©cnica

### 9.1 Bases de Datos

```sql
-- Tabla WEEKS (ya existe)
CREATE TABLE weeks (
  id INTEGER PRIMARY KEY,
  owner_id INTEGER,
  property_id INTEGER,
  start_date DATE,
  end_date DATE,
  color ENUM('red', 'blue', 'white'),
  status ENUM('available', 'confirmed', 'converted', 'used'),
  created_at TIMESTAMP
);

-- Tabla NIGHT_CREDITS (nueva)
CREATE TABLE night_credits (
  id INTEGER PRIMARY KEY,
  owner_id INTEGER,
  week_id INTEGER,              -- Semana que se convirtiÃ³
  nights_available INTEGER,      -- 4, 5, o 6
  nights_used INTEGER DEFAULT 0,
  created_at TIMESTAMP,
  expires_at TIMESTAMP,
  FOREIGN KEY (owner_id) REFERENCES users(id),
  FOREIGN KEY (week_id) REFERENCES weeks(id)
);

-- Tabla NIGHT_CREDIT_USAGE (historial)
CREATE TABLE night_credit_usage (
  id INTEGER PRIMARY KEY,
  credit_id INTEGER,
  booking_id INTEGER,
  nights_consumed INTEGER,
  used_at TIMESTAMP,
  FOREIGN KEY (credit_id) REFERENCES night_credits(id),
  FOREIGN KEY (booking_id) REFERENCES bookings(id)
);
```

### 9.2 Estados de Week

```
ESTADO: available
â”œâ”€ Acciones: Confirmar, Intercambiar, Convertir a crÃ©ditos

ESTADO: confirmed
â”œâ”€ Acciones: Completar uso, Cancelar
â””â”€ PMS: ReservaciÃ³n creada

ESTADO: converted
â”œâ”€ Acciones: Ver crÃ©ditos asociados
â””â”€ PMS: Sin reservaciÃ³n (datos histÃ³ricos)

ESTADO: used
â”œâ”€ Acciones: Ver detalles
â””â”€ PMS: Semana completa, owner presente
```

### 9.3 Endpoints API

```
# ConversiÃ³n
POST /timeshare/weeks/{id}/convert-to-credits
  Request: { week_id }
  Response: { credit_id, nights_available, expires_at }

# Ver CrÃ©ditos
GET /timeshare/night-credits
  Response: [ { id, nights_available, nights_used, expires_at } ]

# Usar CrÃ©ditos
POST /timeshare/night-credits/{id}/use
  Request: { property_id, start_date, end_date, nights }
  Response: { booking_id, nights_remaining, confirmation }

# Historial
GET /timeshare/night-credits/{id}/usage-history
  Response: [ { booking_id, nights_used, used_at } ]
```

---

## 10. Summary: Intercambios vs CrÃ©ditos

### Usa **INTERCAMBIO** si:
- âœ… Quieres **destino especÃ­fico**
- âœ… Quieres **fechas especÃ­ficas**
- âœ… Quieres **otra semana (no crÃ©ditos)**
- âœ… EstÃ¡s dispuesto a pagar â‚¬15

### Usa **CRÃ‰DITOS** si:
- âœ… Quieres **mÃ¡xima flexibilidad**
- âœ… Incierto de fechas/destino
- âœ… Prefieres **mÃºltiples cortos viajes**
- âœ… Quieres **cualquier hotel del grupo**

### Usa **CONFIRMACIÃ“N** si:
- âœ… Seguro usarÃ¡s esa **semana exacta**
- âœ… Ya tienes **planes cerrados**
- âœ… Quieres **garantizar fechas**

---

## 11. PrÃ³ximos Pasos - ImplementaciÃ³n

**Frontend Components:**
- â³ SwapsBrowseTab (ya existe para intercambios)
- â³ CreditsBrowseTab (para usar crÃ©ditos)
- â³ CreditsConversionModal (convertir semana)
- â³ CreditsHistoryView (ver historial)

**Backend:**
- â³ Conversion logic (crear crÃ©ditos)
- â³ Usage tracking (consumir crÃ©ditos)
- â³ Expiration alerts (30 dÃ­as antes de vencer)
- â³ Occupancy reports (llenar espacios vacÃ­os)

---

**ConclusiÃ³n:** 
Los crÃ©ditos y intercambios son **complementarios, no competitivos**. Un owner inteligente usa ambos segÃºn su situaciÃ³n. La plataforma gana en ambos casos: intercambios = fee directo, crÃ©ditos = mejor occupancy.
